{"remainingRequest":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/vue-loader/lib/index.js??vue-loader-options!/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/src/views/child-views/admin-bookings.vue?vue&type=script&lang=js&","dependencies":[{"path":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/src/views/child-views/admin-bookings.vue","mtime":1551430260038},{"path":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport axios from \"axios\";\nimport Modal from \"@/components/reusable/modal.vue\";\nimport Switcher from \"@/components/reusable/switcher.vue\";\nexport default {\n\tcomponents: {\n\t\tmodal: Modal,\n\t\tswitcher: Switcher\n\t},\n\tmounted() {\n\t\tthis.$store.dispatch(\"getAllBookings\");\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tactive: \"all\",\n\t\t\treschedule_date: \"\",\n\t\t\treschedule_slot: \"\",\n\t\t\treschedule_slots: []\n\t\t};\n\t},\n\twatch: {\n\t\treschedule_date() {\n\t\t\tvar formData = new FormData();\n\t\t\tformData.append(\"booking_date\", this.reschedule_date);\n\t\t\tconsole.log(this.$refs.booking.params.package);\n\t\t\tformData.append(\n\t\t\t\t\"package_minutes\",\n\t\t\t\tJSON.parse(this.$refs.booking.params.package).package_minutes\n\t\t\t);\n\t\t\taxios\n\t\t\t\t.post(`/_system/php/api/booking/getOpenSlots.php`, formData)\n\t\t\t\t.then(response => {\n\t\t\t\t\tif (response.data.success) {\n\t\t\t\t\t\tthis.reschedule_slots = response.data.data;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.error(response);\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\treturn [];\n\t\t\t\t});\n\t\t}\n\t},\n\tmethods: {\n    catchParse(thing) {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(thing.replace(/\\n/g, \"<br>\"));\n\t\t\t} catch {\n\t\t\t\tconsole.error(\"catchParse: Error - can't parse \" + thing);\n\t\t\t}\n\t\t},\n\t\treschedule() {\n\t\t\tvar formData = new FormData();\n\t\t\tformData.append(\"booking_id\", this.$refs.booking.params.booking_id);\n\t\t\tformData.append(\"booking_date\", this.reschedule_date);\n\t\t\tformData.append(\"booking_time\", this.reschedule_slot);\n\t\t\taxios\n\t\t\t\t.post(`/_system/php/api/booking/reschedule.php`, formData)\n\t\t\t\t.then(response => {\n\t\t\t\t\tif (response.data.success) {\n\t\t\t\t\t\tthis.$store.dispatch(\"getAllBookings\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.error(response);\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\treturn [];\n\t\t\t\t});\n\t\t}\n\t},\n\tcomputed: {\n\t\tfilteredBookings() {\n\t\t\tvar bookings = this.$store.getters.allBookings;\n\t\t\tif (this.active == \"all\") {\n\t\t\t\treturn bookings;\n\t\t\t} else if (this.active == \"paid\") {\n\t\t\t\treturn bookings.filter(\n\t\t\t\t\tbooking => booking.booking_status == \"AWAITING_CONFIRMATION\"\n\t\t\t\t);\n\t\t\t} else if (this.active == \"overdue\") {\n\t\t\t\treturn bookings.filter(function(booking) {\n\t\t\t\t\tif (booking.booking_status != \"AWAITING_PAYMENT\") {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tvar created = new Date(booking.booking_created);\n\t\t\t\t\tvar now = new Date();\n\t\t\t\t\tvar milihours = now - created;\n\t\t\t\t\tvar hour = milihours / 3.6e6;\n\t\t\t\t\treturn hour > 24;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n};\n",{"version":3,"sources":["admin-bookings.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"admin-bookings.vue","sourceRoot":"src/views/child-views","sourcesContent":["<template lang=\"pug\">\n  div.padding\n    div.flex.wide.justify-space-between\n      //- :Left\n      div: h2 Bookings\n\n      //- Right\n      div\n        a.padding(@click=\"active='all'\" :class=\"{'active':active=='all'}\") Bookings\n        a.padding(@click=\"active='paid'\" :class=\"{'active':active=='paid'}\") Paid\n        a.padding(@click=\"active='overdue'\" :class=\"{'active':active=='overdue'}\") Overdue\n    \n    //- Contents\n    table.wide\n      tr(v-for=\"booking in filteredBookings\")\n        td\n          h3 {{booking.account_name}}\n          h5 {{booking.booking_status}}\n        td\n          button.float-right(@click='$refs.booking.show(booking)') View\n\n    modal(ref=\"booking\" inline-template)\n      div\n        transition(name='fade')\n          #backdrop.fixed-fill(@click=\"toggle\" v-show=\"visible\")\n        transition(name='fade')\n          #modal(v-show=\"visible\").card.fixed-center.flex.column.five-large.seven-medium.twelve-small.max-high\n            div.flex.justify-space-between.align-center.wide\n              h2.padding Booking Details\n              a.padding(@click=\"toggle\"): fa(icon='times')\n            hr\n            div.padding.overflow-auto\n              table.wide\n                tr\n                  td Booked on\n                  td {{params.booking_created}}\n                tr\n                  td Schedule\n                  td {{params.booking_date}}, {{params.booking_time}}\n                tr\n                  td Status\n                  td {{params.booking_status}}\n                tr(v-if=\"params.payment_method=='BANK_DEPOSIT'\")\n                  td Deposit Slip\n                  td: img(:src=\"params.booking_deposit_slip\")\n                tr(v-else=\"params.payment_method=='CREDIT_CARD'\")\n                  td Payment Method\n                  td Credit Card\n              div.flex.wide\n                button.flex-growBooking(@click=\"$store.dispatch('cancelBooking',params.booking_id); visible=false\" v-if=\"params.booking_status!='COMPLETED'\") Cancel Booking\n                button.flex-grow.margin-left-small.primary(@click=\"$store.dispatch('approveBooking',params.booking_id); visible=false\" v-if=`params.booking_status=='AWAITING_CONFIRMATION' || params.booking_status=='AWAITING_PAYMENT'`) Approve Booking\n                button.flex-grow.margin-left-small.primary(v-if=\"params.booking_status=='BOOKED'\" @click=\"$store.dispatch('markAsCompleted',params.booking_id); visible=false\") Mark as Done\n              form.margin-top\n                  fieldset\n                    details\n                      summary Package Details\n                      br\n                      table.wide\n                        tr\n                          td Package Name\n                          td {{ $parent.catchParse(params.package).package_name }}\n                        tr\n                          td Package Description\n                          td(v-html=\"$parent.catchParse(params.package).package_description\")\n                        tr\n                          td Duration\n                          td {{ $parent.catchParse(params.package).package_minutes }} mins\n                        tr\n                          td Addons\n                          td\n                            ul\n                              li(v-for=\"addon in $parent.catchParse(params.package).package_addons\")\n                                span {{ addon.addon_description }}\n                                span {{ addon.addon_type }}\n                                span {{ addon.addon_price }}\n                        tr\n                          td Themes\n                          td\n                            .grid.grid-auto\n                              img(v-for=\"themeid in $parent.catchParse(params.booking_themes)\" :src=\"$store.getters.themes.find(theme => theme.theme_id == themeid).theme_image\" style=\"width: 100%; border-radius: 0.5rem\")\n                        tr\n                          td Total Price\n                          td {{ params.booking_total_price }}\n      \n\n                  fieldset\n                    details\n                      summary Reschedule\n                      div.flex.align-center\n                      input(type=\"date\" v-model=\"$parent.reschedule_date\")\n                      select(v-model=\"$parent.reschedule_slot\")\n                        option(v-for=\"slot in $parent.reschedule_slots\") {{ slot }}\n                      button(@click.prevent=\"toggle(); $parent.reschedule()\") Reschedule\n</template>\n\n<script>\nimport axios from \"axios\";\nimport Modal from \"@/components/reusable/modal.vue\";\nimport Switcher from \"@/components/reusable/switcher.vue\";\nexport default {\n\tcomponents: {\n\t\tmodal: Modal,\n\t\tswitcher: Switcher\n\t},\n\tmounted() {\n\t\tthis.$store.dispatch(\"getAllBookings\");\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tactive: \"all\",\n\t\t\treschedule_date: \"\",\n\t\t\treschedule_slot: \"\",\n\t\t\treschedule_slots: []\n\t\t};\n\t},\n\twatch: {\n\t\treschedule_date() {\n\t\t\tvar formData = new FormData();\n\t\t\tformData.append(\"booking_date\", this.reschedule_date);\n\t\t\tconsole.log(this.$refs.booking.params.package);\n\t\t\tformData.append(\n\t\t\t\t\"package_minutes\",\n\t\t\t\tJSON.parse(this.$refs.booking.params.package).package_minutes\n\t\t\t);\n\t\t\taxios\n\t\t\t\t.post(`/_system/php/api/booking/getOpenSlots.php`, formData)\n\t\t\t\t.then(response => {\n\t\t\t\t\tif (response.data.success) {\n\t\t\t\t\t\tthis.reschedule_slots = response.data.data;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.error(response);\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\treturn [];\n\t\t\t\t});\n\t\t}\n\t},\n\tmethods: {\n    catchParse(thing) {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(thing.replace(/\\n/g, \"<br>\"));\n\t\t\t} catch {\n\t\t\t\tconsole.error(\"catchParse: Error - can't parse \" + thing);\n\t\t\t}\n\t\t},\n\t\treschedule() {\n\t\t\tvar formData = new FormData();\n\t\t\tformData.append(\"booking_id\", this.$refs.booking.params.booking_id);\n\t\t\tformData.append(\"booking_date\", this.reschedule_date);\n\t\t\tformData.append(\"booking_time\", this.reschedule_slot);\n\t\t\taxios\n\t\t\t\t.post(`/_system/php/api/booking/reschedule.php`, formData)\n\t\t\t\t.then(response => {\n\t\t\t\t\tif (response.data.success) {\n\t\t\t\t\t\tthis.$store.dispatch(\"getAllBookings\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.error(response);\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\treturn [];\n\t\t\t\t});\n\t\t}\n\t},\n\tcomputed: {\n\t\tfilteredBookings() {\n\t\t\tvar bookings = this.$store.getters.allBookings;\n\t\t\tif (this.active == \"all\") {\n\t\t\t\treturn bookings;\n\t\t\t} else if (this.active == \"paid\") {\n\t\t\t\treturn bookings.filter(\n\t\t\t\t\tbooking => booking.booking_status == \"AWAITING_CONFIRMATION\"\n\t\t\t\t);\n\t\t\t} else if (this.active == \"overdue\") {\n\t\t\t\treturn bookings.filter(function(booking) {\n\t\t\t\t\tif (booking.booking_status != \"AWAITING_PAYMENT\") {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tvar created = new Date(booking.booking_created);\n\t\t\t\t\tvar now = new Date();\n\t\t\t\t\tvar milihours = now - created;\n\t\t\t\t\tvar hour = milihours / 3.6e6;\n\t\t\t\t\treturn hour > 24;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n};\n</script>\n"]}]}