{"remainingRequest":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/babel-loader/lib/index.js!/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/cache-loader/dist/cjs.js??ref--0-0!/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/vue-loader/lib/index.js??vue-loader-options!/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/src/views/child-views/admin-bookings.vue?vue&type=script&lang=js&","dependencies":[{"path":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/src/views/child-views/admin-bookings.vue","mtime":1551430260038},{"path":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/lucky8548875/SJ Raymundo (2TB)/Documents/Shame/remember-them-little-pwa/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"axios\";\nimport Modal from \"@/components/reusable/modal.vue\";\nimport Switcher from \"@/components/reusable/switcher.vue\";\nexport default {\n  components: {\n    modal: Modal,\n    switcher: Switcher\n  },\n  mounted: function mounted() {\n    this.$store.dispatch(\"getAllBookings\");\n  },\n  data: function data() {\n    return {\n      active: \"all\",\n      reschedule_date: \"\",\n      reschedule_slot: \"\",\n      reschedule_slots: []\n    };\n  },\n  watch: {\n    reschedule_date: function reschedule_date() {\n      var _this = this;\n\n      var formData = new FormData();\n      formData.append(\"booking_date\", this.reschedule_date);\n      console.log(this.$refs.booking.params.package);\n      formData.append(\"package_minutes\", JSON.parse(this.$refs.booking.params.package).package_minutes);\n      axios.post(\"/_system/php/api/booking/getOpenSlots.php\", formData).then(function (response) {\n        if (response.data.success) {\n          _this.reschedule_slots = response.data.data;\n        } else {\n          console.error(response);\n          return [];\n        }\n      }).catch(function (error) {\n        console.log(error);\n        return [];\n      });\n    }\n  },\n  methods: {\n    catchParse: function catchParse(thing) {\n      try {\n        return JSON.parse(thing.replace(/\\n/g, \"<br>\"));\n      } catch (_unused) {\n        console.error(\"catchParse: Error - can't parse \" + thing);\n      }\n    },\n    reschedule: function reschedule() {\n      var _this2 = this;\n\n      var formData = new FormData();\n      formData.append(\"booking_id\", this.$refs.booking.params.booking_id);\n      formData.append(\"booking_date\", this.reschedule_date);\n      formData.append(\"booking_time\", this.reschedule_slot);\n      axios.post(\"/_system/php/api/booking/reschedule.php\", formData).then(function (response) {\n        if (response.data.success) {\n          _this2.$store.dispatch(\"getAllBookings\");\n        } else {\n          console.error(response);\n          return [];\n        }\n      }).catch(function (error) {\n        console.log(error);\n        return [];\n      });\n    }\n  },\n  computed: {\n    filteredBookings: function filteredBookings() {\n      var bookings = this.$store.getters.allBookings;\n\n      if (this.active == \"all\") {\n        return bookings;\n      } else if (this.active == \"paid\") {\n        return bookings.filter(function (booking) {\n          return booking.booking_status == \"AWAITING_CONFIRMATION\";\n        });\n      } else if (this.active == \"overdue\") {\n        return bookings.filter(function (booking) {\n          if (booking.booking_status != \"AWAITING_PAYMENT\") {\n            return false;\n          }\n\n          var created = new Date(booking.booking_created);\n          var now = new Date();\n          var milihours = now - created;\n          var hour = milihours / 3.6e6;\n          return hour > 24;\n        });\n      }\n    }\n  }\n};",{"version":3,"sources":["admin-bookings.vue"],"names":[],"mappings":"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","sourcesContent":["<template lang=\"pug\">\n  div.padding\n    div.flex.wide.justify-space-between\n      //- :Left\n      div: h2 Bookings\n\n      //- Right\n      div\n        a.padding(@click=\"active='all'\" :class=\"{'active':active=='all'}\") Bookings\n        a.padding(@click=\"active='paid'\" :class=\"{'active':active=='paid'}\") Paid\n        a.padding(@click=\"active='overdue'\" :class=\"{'active':active=='overdue'}\") Overdue\n    \n    //- Contents\n    table.wide\n      tr(v-for=\"booking in filteredBookings\")\n        td\n          h3 {{booking.account_name}}\n          h5 {{booking.booking_status}}\n        td\n          button.float-right(@click='$refs.booking.show(booking)') View\n\n    modal(ref=\"booking\" inline-template)\n      div\n        transition(name='fade')\n          #backdrop.fixed-fill(@click=\"toggle\" v-show=\"visible\")\n        transition(name='fade')\n          #modal(v-show=\"visible\").card.fixed-center.flex.column.five-large.seven-medium.twelve-small.max-high\n            div.flex.justify-space-between.align-center.wide\n              h2.padding Booking Details\n              a.padding(@click=\"toggle\"): fa(icon='times')\n            hr\n            div.padding.overflow-auto\n              table.wide\n                tr\n                  td Booked on\n                  td {{params.booking_created}}\n                tr\n                  td Schedule\n                  td {{params.booking_date}}, {{params.booking_time}}\n                tr\n                  td Status\n                  td {{params.booking_status}}\n                tr(v-if=\"params.payment_method=='BANK_DEPOSIT'\")\n                  td Deposit Slip\n                  td: img(:src=\"params.booking_deposit_slip\")\n                tr(v-else=\"params.payment_method=='CREDIT_CARD'\")\n                  td Payment Method\n                  td Credit Card\n              div.flex.wide\n                button.flex-growBooking(@click=\"$store.dispatch('cancelBooking',params.booking_id); visible=false\" v-if=\"params.booking_status!='COMPLETED'\") Cancel Booking\n                button.flex-grow.margin-left-small.primary(@click=\"$store.dispatch('approveBooking',params.booking_id); visible=false\" v-if=`params.booking_status=='AWAITING_CONFIRMATION' || params.booking_status=='AWAITING_PAYMENT'`) Approve Booking\n                button.flex-grow.margin-left-small.primary(v-if=\"params.booking_status=='BOOKED'\" @click=\"$store.dispatch('markAsCompleted',params.booking_id); visible=false\") Mark as Done\n              form.margin-top\n                  fieldset\n                    details\n                      summary Package Details\n                      br\n                      table.wide\n                        tr\n                          td Package Name\n                          td {{ $parent.catchParse(params.package).package_name }}\n                        tr\n                          td Package Description\n                          td(v-html=\"$parent.catchParse(params.package).package_description\")\n                        tr\n                          td Duration\n                          td {{ $parent.catchParse(params.package).package_minutes }} mins\n                        tr\n                          td Addons\n                          td\n                            ul\n                              li(v-for=\"addon in $parent.catchParse(params.package).package_addons\")\n                                span {{ addon.addon_description }}\n                                span {{ addon.addon_type }}\n                                span {{ addon.addon_price }}\n                        tr\n                          td Themes\n                          td\n                            .grid.grid-auto\n                              img(v-for=\"themeid in $parent.catchParse(params.booking_themes)\" :src=\"$store.getters.themes.find(theme => theme.theme_id == themeid).theme_image\" style=\"width: 100%; border-radius: 0.5rem\")\n                        tr\n                          td Total Price\n                          td {{ params.booking_total_price }}\n      \n\n                  fieldset\n                    details\n                      summary Reschedule\n                      div.flex.align-center\n                      input(type=\"date\" v-model=\"$parent.reschedule_date\")\n                      select(v-model=\"$parent.reschedule_slot\")\n                        option(v-for=\"slot in $parent.reschedule_slots\") {{ slot }}\n                      button(@click.prevent=\"toggle(); $parent.reschedule()\") Reschedule\n</template>\n\n<script>\nimport axios from \"axios\";\nimport Modal from \"@/components/reusable/modal.vue\";\nimport Switcher from \"@/components/reusable/switcher.vue\";\nexport default {\n\tcomponents: {\n\t\tmodal: Modal,\n\t\tswitcher: Switcher\n\t},\n\tmounted() {\n\t\tthis.$store.dispatch(\"getAllBookings\");\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tactive: \"all\",\n\t\t\treschedule_date: \"\",\n\t\t\treschedule_slot: \"\",\n\t\t\treschedule_slots: []\n\t\t};\n\t},\n\twatch: {\n\t\treschedule_date() {\n\t\t\tvar formData = new FormData();\n\t\t\tformData.append(\"booking_date\", this.reschedule_date);\n\t\t\tconsole.log(this.$refs.booking.params.package);\n\t\t\tformData.append(\n\t\t\t\t\"package_minutes\",\n\t\t\t\tJSON.parse(this.$refs.booking.params.package).package_minutes\n\t\t\t);\n\t\t\taxios\n\t\t\t\t.post(`/_system/php/api/booking/getOpenSlots.php`, formData)\n\t\t\t\t.then(response => {\n\t\t\t\t\tif (response.data.success) {\n\t\t\t\t\t\tthis.reschedule_slots = response.data.data;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.error(response);\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\treturn [];\n\t\t\t\t});\n\t\t}\n\t},\n\tmethods: {\n    catchParse(thing) {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(thing.replace(/\\n/g, \"<br>\"));\n\t\t\t} catch {\n\t\t\t\tconsole.error(\"catchParse: Error - can't parse \" + thing);\n\t\t\t}\n\t\t},\n\t\treschedule() {\n\t\t\tvar formData = new FormData();\n\t\t\tformData.append(\"booking_id\", this.$refs.booking.params.booking_id);\n\t\t\tformData.append(\"booking_date\", this.reschedule_date);\n\t\t\tformData.append(\"booking_time\", this.reschedule_slot);\n\t\t\taxios\n\t\t\t\t.post(`/_system/php/api/booking/reschedule.php`, formData)\n\t\t\t\t.then(response => {\n\t\t\t\t\tif (response.data.success) {\n\t\t\t\t\t\tthis.$store.dispatch(\"getAllBookings\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.error(response);\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\treturn [];\n\t\t\t\t});\n\t\t}\n\t},\n\tcomputed: {\n\t\tfilteredBookings() {\n\t\t\tvar bookings = this.$store.getters.allBookings;\n\t\t\tif (this.active == \"all\") {\n\t\t\t\treturn bookings;\n\t\t\t} else if (this.active == \"paid\") {\n\t\t\t\treturn bookings.filter(\n\t\t\t\t\tbooking => booking.booking_status == \"AWAITING_CONFIRMATION\"\n\t\t\t\t);\n\t\t\t} else if (this.active == \"overdue\") {\n\t\t\t\treturn bookings.filter(function(booking) {\n\t\t\t\t\tif (booking.booking_status != \"AWAITING_PAYMENT\") {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tvar created = new Date(booking.booking_created);\n\t\t\t\t\tvar now = new Date();\n\t\t\t\t\tvar milihours = now - created;\n\t\t\t\t\tvar hour = milihours / 3.6e6;\n\t\t\t\t\treturn hour > 24;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n};\n</script>\n"],"sourceRoot":"src/views/child-views"}]}